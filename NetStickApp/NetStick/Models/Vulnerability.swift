//
//  Vulnerability.swift
//  NetStick
//
//  Created by conv3 on 2026-01-06.
//

import Foundation
import SwiftUI

/// Represents a vulnerability found during analysis
struct Vulnerability: Identifiable, Hashable {
    let id = UUID()
    let cve: String
    let severity: Int
    let description: String
    
    /// Severity level as enum
    var severityLevel: SeverityLevel {
        switch severity {
        case 9...10:
            return .critical
        case 7...8:
            return .high
        case 4...6:
            return .medium
        case 1...3:
            return .low
        default:
            return .info
        }
    }
    
    /// Color based on severity
    var color: Color {
        switch severityLevel {
        case .critical: return .red
        case .high: return .orange
        case .medium: return .yellow
        case .low: return .green
        case .info: return .blue
        }
    }
    
    static func == (lhs: Vulnerability, rhs: Vulnerability) -> Bool {
        lhs.cve == rhs.cve
    }
    
    func hash(into hasher: inout Hasher) {
        hasher.combine(cve)
    }
}

/// Severity level enum
enum SeverityLevel: String {
    case critical = "Critical"
    case high = "High"
    case medium = "Medium"
    case low = "Low"
    case info = "Info"
}
